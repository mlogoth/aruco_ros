<launch>

  <arg name="camera_name" default="usb_cam"/>
  <arg name="camera_frame_id" default="usb_cam"/>
  <arg name="device" default="/dev/video2"/>
  <arg name="idVendor" default="0x1415"/>
  <arg name="idProduct" default="0x2000"/>
  <arg name="index" default="1"/>
  <arg name="image_width" default="320"/>
  <arg name="image_height" default="240"/>
  <arg name="frame_rate" default="120"/>
  <arg name="pixel_format" default="yuyv"/>

  <arg name="pkg" default="usb_cam"/>


  <group if="$(eval arg('pkg') == 'usb_cam')">
  <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen" >
        <param name="video_device" value="$(arg device)" />
        <param name="image_width" value="$(arg image_width)" />
        <param name="image_height" value="$(arg image_height)" />
        <param name="pixel_format" value="$(arg pixel_format)" />
        <param name="camera_frame_id" value="$(arg camera_frame_id)" />
        <param name="framerate" value="$(arg frame_rate)"/>
        <!-- <param name="io_method" value="mmap"/> -->
  </node>
  </group>

  <group if="$(eval arg('pkg') == 'libuvc_camera')">
  <group ns="$(arg camera_name)">
      <node pkg="libuvc_camera" type="camera_node" name="mycam">
            <!-- Parameters used to find the camera -->
            <param name="vendor" value="$(arg idVendor)"/>
            <param name="product" value="$(arg idProduct)"/>
            <param name="serial" value=""/>
            <!-- If the above parameters aren't unique, choose the first match: -->
            <param name="index" value="$(arg index)"/>

            <!-- Image size and type -->
            <param name="width" value="$(arg image_width)"/>
            <param name="height" value="$(arg image_height)"/>
            <!-- choose whichever uncompressed format the camera supports: -->
            <param name="video_mode" value="$(arg pixel_format)"/> <!-- or yuyv/nv12/mjpeg -->
            <param name="frame_rate" value="$(arg frame_rate)"/>

            <param name="timestamp_method" value="start"/> <!-- start of frame -->
            <param name="camera_info_url" value="file:///tmp/cam.yaml"/>

            <param name="auto_exposure" value="3"/> <!-- use aperture_priority auto exposure -->
            <param name="auto_white_balance" value="false"/>
      </node>
   </group>
   </group>


  <node name="image_view" pkg="image_view" type="image_view" respawn="false" output="screen">
        <remap from="image" to="/$(arg camera_name)/image_raw"/>
        <param name="autosize" value="true" />
  </node>
</launch>